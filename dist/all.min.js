"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Krakout=function t(e){function n(){function t(e,n,o){var r={};if("string"!=typeof n){for(var i in n)r[n[i]]=t(e,n[i],o);return r}var a=document.createElement("canvas");return a.id=a.className="krakout-canvas-"+n,o(a),a.getContext("2d")}function n(t){var e=parseFloat(window.getComputedStyle(t).width),n=parseFloat(window.getComputedStyle(t).height);return function(o){o.width=c,o.height=s,o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.width=c,o.style.height=s,o.style.transform="scale3d("+e/c+", "+n/s+", 1)",o.style.transformOrigin="top left",t.appendChild(o)}}l=a._canvas=t(e,["ball","board","layout"],n(e));var o=a.loadMod("PlainBoard",l.board,{controller:a});e.addEventListener("mousemove",function(t){o.change({x:t.screenX/a.ratioWidth})});var r=a.loadMod("PlainBall",l.ball,{controller:a}),i=a.balls=[];i.push(r)}var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,t);var r=4096,i=2160,a=this,l=void 0,c=a.width=o.width||r,s=a.height=o.height||i,u=a.screenWidth=parseFloat(getComputedStyle(e).width),f=(a.ratioWidth=u/c,a.screenHeight=parseFloat(getComputedStyle(e).height));a.ratioHeight=f/s;n()};Krakout.module=Krakout.module||{},Krakout.getMod=function(t){return Krakout.module[t]},Krakout.prototype.loadMod=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;e>o;o++)n[o-1]=arguments[o];return new(Function.prototype.bind.apply(Krakout.getMod(t),[null].concat(n)))};var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();Krakout.module.ModuleBase=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,t);var o=this;o.ctx=e,o.canvas=e.canvas,o.config=n,n.x=n.x||0,n.y=n.y||0,n.containerWidth=n.controller.width||0,n.containerHeight=n.controller.height||0,o.initReady(),o.reDraw(),o.initComplete()}return _createClass(t,[{key:"change",value:function(t){for(var e in t)this.config[e]=t[e];this.reDraw()}},{key:"clear",value:function(){this.canvas.width=this.canvas.width}},{key:"initReady",value:function(){}},{key:"beforeDraw",value:function(){this.clear()}},{key:"draw",value:function(){}},{key:"afterDraw",value:function(){}},{key:"initComplete",value:function(){}},{key:"reDraw",value:function(){this.beforeDraw(),this.draw(),this.afterDraw()}}]),t}(),Krakout.module.Board=function(t){function e(t,n){return _classCallCheck(this,e),n.width=n.width||400,n.height=n.height||20,n.x=(n.controller.width-n.width)/2,n.y=n.controller.height-n.height,_possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,t,n))}return _inherits(e,t),e}(Krakout.module.ModuleBase);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();Krakout.module.Ball=function(t){function e(t,n){return _classCallCheck(this,e),n.width=n.width||20,n.x=(n.controller.width-n.width)/2,n.y=n.controller.height-n.width-20,n.stride=30,_possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,t,n))}return _inherits(e,t),_createClass(e,[{key:"fire",value:function(){this.offsetX=14*Math.random()|1,this.offsetY=this.config.stride-this.offsetX,this.proceed()}},{key:"proceed",value:function(){var t=this,e=function n(){t.accessMove(),t.moveFlag=requestAnimationFrame(n)};t.moveFlag=requestAnimationFrame(e)}},{key:"pause",value:function(){cancelAnimationFrame(this.moveFlag)}},{key:"accessMove",value:function(){var t=this.config,e=t.x,n=t.y;(0>=e||e+t.width>=t.containerWidth)&&(this.offsetX=~this.offsetX+1),(0>=n||n+t.width>=t.containerHeight)&&(this.offsetY=~this.offsetY+1),this.change({x:e-this.offsetX,y:n-this.offsetY})}}]),e}(Krakout.module.ModuleBase);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();Krakout.module.PlainBoard=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,Object.getPrototypeOf(e).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"draw",value:function(){var t=this.ctx,e=this.config,n=new Path2D;n.rect(e.x,e.y,e.width,e.height),t.fill(n)}},{key:"initComplete",value:function(){}}]),e}(Krakout.module.Board);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();Krakout.module.PlainBall=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,Object.getPrototypeOf(e).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"draw",value:function(){var t=this.ctx,e=this.config,n=new Path2D;n.arc(e.x,e.y,e.width,0,2*Math.PI),t.fill(n)}},{key:"initComplete",value:function(){this.fire()}}]),e}(Krakout.module.Ball);